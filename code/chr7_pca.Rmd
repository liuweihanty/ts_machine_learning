---
title: "Chr7 Gene PCA"
author: "Shirley Zhou"
date: "11/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r read data}
chr7 <- read.csv("../data/chr7_work_data.csv", header = TRUE)
rownames(chr7) <- chr7$Gene
drop <- c('X','Gene','ENSEMBL_ID')
chr7 <- chr7[,!(names(chr7) %in% drop)]
head(chr7)
```

```{r}
chr7
```

```{r PCA}
pr.out <- prcomp(chr7[,-1], scale = TRUE, center = TRUE)
summary(pr.out)
```


```{r PVE and scree plot}
pr.var <- pr.out$sdev^2
pve <- pr.var / sum(pr.var)
plot(pve, xlab = "Principal Component",
     ylab = "Proportion of Variance Explained",
     ylim = c(0, 1), type = "b")
#or you can just use: fviz_eig(pr.out,ncp = 20)

plot(cumsum(pve), xlab = "Principal Component",
     ylab = "Cumulative Proportion of Variance Explained",
     ylim = c(0, 1), type = "b")
```


PCA biplot
```{r,fig.width= 8, fig.height=6}
library("factoextra")
fviz_pca_ind(pr.out,
             habillage = chr7$type,
             label = "none",
             palette = c("#00AFBB", "#E7B800", "#FC4E07", "#9900FF"),
             addEllipses=TRUE
             )
```


```{r}
iris.pca <- prcomp(iris[,-5])
# Visualize
# Use habillage to specify groups for coloring
fviz_pca_ind(iris.pca,
             label = "none", # hide individual labels
             habillage = iris$Species, # color by groups
             palette = c("#00AFBB", "#E7B800", "#FC4E07"),
             addEllipses = TRUE # Concentration ellipses
             )
```

```{r}
iris
```